import type { CodeExecutionMode, INode, ITaskDataConnections, WorkflowParameters, IDataObject, IExecuteData, INodeExecutionData, INodeParameters, IRunExecutionData, WorkflowExecuteMode, EnvProviderState } from 'n8n-workflow';
import type { TaskResultData } from '../runner-types';
import { type Task, TaskRunner } from '../task-runner';
export interface JSExecSettings {
    code: string;
    nodeMode: CodeExecutionMode;
    workflowMode: WorkflowExecuteMode;
    continueOnFail: boolean;
    mode: WorkflowExecuteMode;
}
export interface PartialAdditionalData {
    executionId?: string;
    restartExecutionId?: string;
    restApiUrl: string;
    instanceBaseUrl: string;
    formWaitingBaseUrl: string;
    webhookBaseUrl: string;
    webhookWaitingBaseUrl: string;
    webhookTestBaseUrl: string;
    currentNodeParameters?: INodeParameters;
    executionTimeoutTimestamp?: number;
    userId?: string;
    variables: IDataObject;
}
export interface AllCodeTaskData {
    workflow: Omit<WorkflowParameters, 'nodeTypes'>;
    inputData: ITaskDataConnections;
    node: INode;
    runExecutionData: IRunExecutionData;
    runIndex: number;
    itemIndex: number;
    activeNodeName: string;
    connectionInputData: INodeExecutionData[];
    siblingParameters: INodeParameters;
    mode: WorkflowExecuteMode;
    envProviderState?: EnvProviderState;
    executeData?: IExecuteData;
    defaultReturnRunIndex: number;
    selfData: IDataObject;
    contextNodeName: string;
    additionalData: PartialAdditionalData;
}
export interface JsTaskRunnerOpts {
    wsUrl: string;
    grantToken: string;
    maxConcurrency: number;
    name?: string;
    allowedBuiltInModules?: string;
    allowedExternalModules?: string;
}
export declare class JsTaskRunner extends TaskRunner {
    private readonly requireResolver;
    constructor({ grantToken, maxConcurrency, wsUrl, name, allowedBuiltInModules, allowedExternalModules, }: JsTaskRunnerOpts);
    executeTask(task: Task<JSExecSettings>): Promise<TaskResultData>;
    private runForAllItems;
    private runForEachItem;
    private createDataProxy;
    private toExecutionErrorIfNeeded;
}
